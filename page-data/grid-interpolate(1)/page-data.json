{"componentChunkName":"component---src-templates-blog-post-index-jsx","path":"/grid-interpolate(1)/","result":{"data":{"site":{"siteMetadata":{"title":"QDS"}},"markdownRemark":{"id":"9d1283b9-0b7c-5a3c-9755-db3354f82636","excerpt":"关于MeteoInfoLab MeotoInfoLab对于处理气象相关的工作是十分有用且高效的。MeotoInfoLab是使用的jython脚本进行开发，是一个好消息但仔细想想也很难让人接受。可以使用基本Python3的语法但无法使用丰富的cpython包，但也MatLab、Numpy、Matplotlib…","html":"<h2>关于MeteoInfoLab</h2>\n<p>MeotoInfoLab对于处理气象相关的工作是十分有用且高效的。MeotoInfoLab是使用的jython脚本进行开发，是一个好消息但仔细想想也很难让人接受。可以使用基本Python3的语法但无法使用丰富的cpython包，但也MatLab、Numpy、Matplotlib实现了一些函数，可以满足部分的需求。具体的信息以及学习的脚本可以看<a href=\"http://bbs.06climate.com/forum.php?mod=viewthread&#x26;tid=36151&#x26;highlight=meteoinfolab\">气象家园</a>相关内容。</p>\n<h2>使用关于MeteoInfoLab实现插值</h2>\n<p>在这里借助气象家园的插值脚本进行改写，可以多看看的<a href=\"http://bbs.06climate.com/forum.php?mod=viewthread&#x26;tid=36422&#x26;extra=page%3D1\">原始脚本=》》</a>。</p>\n<h3>分析脚本</h3>\n<p>原始脚本中最关键的函数就是插值函数griddata(),主要需要两个参数：坐标的经度和坐标的纬度组成的坐标点(<em>list</em>),以及坐标相对应的特征值，比如温度、风速、降水等信息(<em>array_like</em>)。除外还需要插值的目标点坐标，插值的方法（idw | cressman | nearest | inside | inside<em>min\n| inside</em>max | inside_count | surface | barnes）以及插值方式对应所需要的参数。但调好这些参数确实需要一些经验，对于我这种小白就用默认的值吧。</p>\n<h3>具体实现</h3>\n<p>数据点经度是以范围为[73.03125, 136.96875]以0.0625间距的点，数据点纬度是以范围为[18.03125, 55.96875]以0.0625间距的点。对应的点坐标数据存储在txt文件中以空格分隔。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lat <span class=\"token operator\">=</span> arange<span class=\"token punctuation\">(</span><span class=\"token number\">18.03125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">55.96875</span><span class=\"token operator\">+</span><span class=\"token number\">0.0625</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.0625</span><span class=\"token punctuation\">,</span><span class=\"token string\">'float64'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">#纬度</span>\nlon <span class=\"token operator\">=</span> arange<span class=\"token punctuation\">(</span><span class=\"token number\">73.03125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">136.96875</span><span class=\"token operator\">+</span><span class=\"token number\">0.0625</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.0625</span><span class=\"token punctuation\">,</span><span class=\"token string\">'float64'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#经度</span>\nlon_repeat<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>val <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>lat<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> val <span class=\"token keyword\">in</span> lon<span class=\"token punctuation\">]</span>\nlat_repeat<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>val <span class=\"token keyword\">for</span> val <span class=\"token keyword\">in</span> lat <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>lon<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/home/qianh/workspace/share/linhuo/20200521.txt\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    data <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>readlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    temdata<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>line<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">]</span>\nfinalData<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> temp <span class=\"token keyword\">in</span> temdata <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> temp<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\nx <span class=\"token operator\">=</span> arange<span class=\"token punctuation\">(</span><span class=\"token number\">75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">135</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0625</span><span class=\"token punctuation\">)</span>\ny <span class=\"token operator\">=</span> arange<span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">55</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0625</span><span class=\"token punctuation\">)</span>\nprg <span class=\"token operator\">=</span> griddata<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>NDArray<span class=\"token punctuation\">(</span>lon_repeat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>NDArray<span class=\"token punctuation\">(</span>lat_repeat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> NDArray<span class=\"token punctuation\">(</span>finalData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> xi<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> method<span class=\"token operator\">=</span><span class=\"token string\">'idw'</span><span class=\"token punctuation\">,</span> radius<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\">#prg = griddata((NDArray(lon_repeat),NDArray(lat_repeat)), NDArray(finalData), xi=(x, y), method='cressman', radius=[0.1])[0]</span>\nfigure<span class=\"token punctuation\">(</span>newfig<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#每次运行可以添加一个新的figure</span>\nbou1_layer <span class=\"token operator\">=</span> geoshow<span class=\"token punctuation\">(</span><span class=\"token string\">'cn_border'</span><span class=\"token punctuation\">,</span> facecolor<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nchina_layer <span class=\"token operator\">=</span> geoshow<span class=\"token punctuation\">(</span><span class=\"token string\">'china'</span><span class=\"token punctuation\">,</span> visible<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nlevs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span>\ncols <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">206</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">252</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span><span class=\"token number\">183</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">120</span><span class=\"token punctuation\">,</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">81</span><span class=\"token punctuation\">,</span><span class=\"token number\">203</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span><span class=\"token number\">210</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \\\n    <span class=\"token punctuation\">(</span><span class=\"token number\">136</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">240</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">106</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">76</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">105</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\nlayer <span class=\"token operator\">=</span> contourfm<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> prg<span class=\"token punctuation\">,</span> levs<span class=\"token punctuation\">,</span> colors<span class=\"token operator\">=</span>cols<span class=\"token punctuation\">)</span>\nmasklayer<span class=\"token punctuation\">(</span>china_layer<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>layer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ncolorbar<span class=\"token punctuation\">(</span>layer<span class=\"token punctuation\">)</span>\nxlim<span class=\"token punctuation\">(</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">136</span><span class=\"token punctuation\">)</span>\nylim<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">55</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>==其中要注意将list格式数据转换为NDArray类型的，不然会报错 #4CAF50==。其中的插值目标点的间距可以自行修改，本脚本采用的是0.0625。cressman和idw的对应参数(radius)也可以进行调整。levs是图例的范围和下面的cols一一对应。最后展示运行数据图<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/Charging/static/85baf5c2eb83de381454ba703c7c681a/e8e04/meteoinfo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABeUlEQVQoz3VSPUsDQRDNX7SwE/0FYpNGsLPwX1goCobEVKJYpBGSIGghBBLDgQqXGDV33Ff2e5+ze0kImiw8Zmdu5s2b26mAjrUWC6uUgpQKWpeQ5Ks5fJxsnAmEEXMVGH9MkKfFsr6ySiilBGPcJwppwITxd2ONBxzoPMUK3WFJ0rp6xntv7O/G/CEUQhC448BLqtFLDTJBqjWREhTlnNSmODz9QTeSEOS3GxN8DmalQvNPoUCachoPiImgoPhcFCQRO03Vmwh7+yHOu5mPN+9G6AfFeoWOsCg4jeuDPhYqg8tghpz8nHz35+Y9/Kl33tAfpSWh3TCy1o7covclcUSKds8mOLiPUPvmaL0yXDQS6LIEzSDCIBGbCTnny+6cRlczi9upxvH1FFvbAao7AR7qcZlAZe0sR2jM5lfmnPkV0STTrYi1GnEhoDKF4WMBkdM3KylH+/woSfxqrSV01lA3p9KRLqwkqw0R0bsq2k23Wi7OWNl8tf4XR0GylfXWLLIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"全国降水图\"\n        title=\"全国降水图\"\n        src=\"/Charging/static/85baf5c2eb83de381454ba703c7c681a/fcda8/meteoinfo.png\"\n        srcset=\"/Charging/static/85baf5c2eb83de381454ba703c7c681a/12f09/meteoinfo.png 148w,\n/Charging/static/85baf5c2eb83de381454ba703c7c681a/e4a3f/meteoinfo.png 295w,\n/Charging/static/85baf5c2eb83de381454ba703c7c681a/fcda8/meteoinfo.png 590w,\n/Charging/static/85baf5c2eb83de381454ba703c7c681a/efc66/meteoinfo.png 885w,\n/Charging/static/85baf5c2eb83de381454ba703c7c681a/c83ae/meteoinfo.png 1180w,\n/Charging/static/85baf5c2eb83de381454ba703c7c681a/e8e04/meteoinfo.png 1270w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"学习插值(一)","date":"June 04, 2020","description":"Hello World"}}},"pageContext":{"slug":"/grid-interpolate(1)/","previous":{"id":"5d69a6e6-ee29-51b3-bc05-8730f7b6fb7a","frontmatter":{"title":"新公司第一天","tags":["life","随笔"],"date":"2020年05月12日"},"fields":{"slug":"/life_newCompany/"},"excerpt":"上午 或许是太久没有上班了吧。还记得上次上班还是在2月初，那个时候刚刚在家上班一周就被停掉了，这一停就停到到了现在。这家公司是大概是在…"},"next":null}}}